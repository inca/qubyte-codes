<!doctype html>
<html lang="en">
<head>
  <meta name="viewport" content="initial-scale=1">
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" />
  <title>Qubyte Codes - Interfaces for JavaScript</title>
  <script src="../main.js" defer></script>
  <style>
    a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}table{border-collapse:collapse;border-spacing:0}body{font-family:Palatino,'Palatino Linotype','Palatino LT STD','Book Antiqua',Georgia,serif;max-width:800px;text-align:center;margin:0 auto;background-color:#F1E7CD}.top-header{text-align:center;position:fixed;margin:0;top:0;width:100%;max-width:800px;background-color:#F1E7CD}.content{text-align:left;margin:0 1rem;padding-top:6rem}header{margin:1rem 0}article,footer{margin:2rem 0}h1{font-size:2rem;margin:1rem 0;transition:all .3s}h1.smaller{font-size:1rem;margin:.5rem 0}h2{font-size:2rem;margin:1rem 0}h3{font-size:1.5rem;margin:1rem 0}p{margin:1rem 0;line-height:1.2em;text-align:justify}.quote p:before{content:"\0022"}.quote p:after{content:" ...\0022"}pre{margin:1rem 0;white-space:pre-wrap}code{font-family:monospace}a{color:inherit;text-decoration:none}p>a{text-decoration:underline}em{font-style:italic}table{margin:1rem 0;text-align:left;width:100%}thead{border-bottom:solid 1px}td,th{padding:.5rem}nav{padding:.5rem;border-top:1px #000 solid;border-bottom:1px #000 solid}nav>ul>li{display:inline;margin:.5rem}pre{padding:.5rem;border:1px #000 solid;background-color:#fff}.embed-container{position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%}.embed-container embed,.embed-container iframe,.embed-container object{position:absolute;top:0;left:0;width:100%;height:100%}.scroll-progress{position:fixed;top:0;left:0;height:.125rem;background-color:#000}.hljs{display:block;overflow-x:auto;padding:.5em;background:#F0F0F0}.hljs,.hljs-subst{color:#444}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-meta-keyword,.hljs-name,.hljs-selector-tag{font-weight:700}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code,.hljs-literal{color:#1F811F}.hljs-link,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#BC6060}.hljs-deletion,.hljs-number,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#800}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-comment{color:#888}.hljs-meta{color:#2B6EA1}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}
  </style>
</head>
<body>
  <header class="top-header">
    <h1><a href="/">Qubyte Codes</a></h1>
    <nav>
      <ul>
        <li><a href="/">archive</a></li>
        <li><a href="/about">about</a></li>
      </ul>
    </nav>
  </header>
  <div class="content">
    <article>
      <header>
        <h2>Interfaces for JavaScript</h2>
        <time datetime="2016-03-13T10:45Z">Sun Mar 13 2016</time>
      </header>
      <p>I use <code>instanceof</code> a lot in JavaScript. It&#39;s very handy when writing unit tests. It&#39;s easier to do
an <code>instanceof</code> check than it is to exhaustively probe an object.</p>
<p>Unfortunately <code>instanceof</code> usually means an object has been constructed. If the constructed object
is coming from a third party library, or there is no access to the constructor, it can become
fiddly.</p>
<p>This is why I&#39;m excited about ES2015s <code>Symbol.hasInstance</code>. It allows you to tune the behaviour of
<code>instanceof</code> for a class. Here&#39;s a minimal example of an <em>interface class</em>:</p>
<pre><code class="lang-javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PositiveInteger</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'PositiveInteger is an interface class.'</span>);
  }

  static [<span class="hljs-built_in">Symbol</span>.hasInstance](value) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'number'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">return</span> value % <span class="hljs-number">1</span> === <span class="hljs-number">0</span>;
  }
}

assert.ok(<span class="hljs-number">10</span> <span class="hljs-keyword">instanceof</span> PositiveInteger);   <span class="hljs-comment">// does not throw</span>
assert.ok(<span class="hljs-number">-10</span> <span class="hljs-keyword">instanceof</span> PositiveInteger);  <span class="hljs-comment">// throws</span>
assert.ok(<span class="hljs-string">'hi'</span> <span class="hljs-keyword">instanceof</span> PositiveInteger); <span class="hljs-comment">// throws</span>
<span class="hljs-keyword">var</span> positiveInt = <span class="hljs-keyword">new</span> PositiveInteger();    <span class="hljs-comment">// throws</span>
</code></pre>
<p>The class above exists <em>only</em> to provide this <code>instanceof</code> check. A more interesting example might
be a view. I assert that a view has an element, and render and remove methods. An interface class
for this might be:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title">View</span> {
  constructor() {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error(<span class="hljs-string">'View is an interface class.'</span>);
  }

  <span class="hljs-keyword">static</span> [Symbol.hasInstance](<span class="hljs-keyword">value</span>) {    
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">value</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">value</span>.render !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">value</span>.remove !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">value</span>.element instanceof HTMLElement;
  }
}
</code></pre>
<p>Now view objects can come from any source as long as they have render and remove methods and an
element. Objects which implement various interface classes also mean that these interface classes
don&#39;t have to be in the same prototype chain. In other words, it gives you a way to use <code>instanceof</code>
without invoking inheritance.</p>
<p>Sadly <code>hasInstance</code> will be one of the last ES2015 features to make it into browsers, so we&#39;ll have
to wait a while before we can use it. See
<a href="http://kangax.github.io/compat-table/es6/#test-well-known_symbols_Symbol.hasInstance">the compatibility table</a>.</p>

    </article>
    <footer>
      <p>Feel like sharing? <a href="https://twitter.com/intent/tweet?via=qubyte&text=Qubyte%20Codes%20-%20Interfaces%20for%20JavaScript&url=https%3A%2F%2Fqubyte.codes%2Fblog%2Finterfaces-for-javascript&hashtags=javascript">Tweet this post!</a></p>
      <p>Comments or corrections? <a href="https://twitter.com/intent/tweet?screen_name=qubyte">Send me a tweet!</a></p>
    </footer>
  </div>
</body>
</html>
